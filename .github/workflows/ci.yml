name: CI

on: [push, pull_request]

jobs:
  wit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install wit-bindgen
        run: cargo install --locked wit-bindgen-cli
      - name: Install wasm-tools
        run: cargo install --locked wasm-tools
      - name: Install wkg
        run: curl -fsSL https://wkg.dev/install.sh | bash
      - run: bash scripts/validate-wit.sh

  rust:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: dtolnay/rust-toolchain@stable
      - run: cargo build
