// SPDX-License-Identifier: MIT

package greentic:secrets-generators@0.1.0;

use greentic:secrets-provider/types@0.1.0;

/// Secret generation interface for provider-agnostic rotation flows.
interface generators-api {
  use greentic:secrets-provider/types@0.1.0.{
    correlation,
    error,
    kv,
    secret-ref,
  };

  /// Result of a generator run.
  record generate-result {
    secret: secret-ref,
    value: list<u8>,
    content-type: option<string>,
    tags: list<kv>,
    ttl-seconds: option<u64>,
  }

  /// Produces a secret payload using a policy/recipe encoded as JSON.
  generate: func(policy-json: string, ctx: correlation) -> result<generate-result, error>;
}

world generators {
  export generators-api;
}
